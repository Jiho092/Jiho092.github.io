---
layout: single
title: "에어비앤비 데이터처리" #제목
categories: 
    - Project #카테고리설정
tag: 
    - ["파이썬"] #테그
---



# 0. 필요 모듈


```python
import pandas as pd
import re
```

데이터를 문자열로 처리하기 위해 pandas와 re 모듈을 import한다.


# 1. 데이터 불러오기 및 확인


```python
air = pd.read_csv("AIRBNB.csv")
air = air.drop_duplicates() #중복제거
```


```python
air.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>detail_info</th>
      <th>per_price</th>
      <th>total_price</th>
      <th>star_info</th>
      <th>region</th>
      <th>star</th>
      <th>star_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>표선면, 서귀포시의 집</td>
      <td>표선맨션 A301</td>
      <td>164330.0</td>
      <td>총 요금: 328,659</td>
      <td>4.64 (33)</td>
      <td>성산읍</td>
      <td>4.64</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>서귀포시의 개인실</td>
      <td>오조리비앤비,우도와 성산일출봉을 동시에 펜트하우스^^(301호)</td>
      <td>127241.0</td>
      <td>총 요금: 254,482</td>
      <td>4.69 (31)</td>
      <td>성산읍</td>
      <td>4.69</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Gujwa-eup, 특별자치도, Cheju의 펜션</td>
      <td>성산일출봉과 우도를 담은 오션뷰 애견동반펜션 - 14평 원룸(취사불가)</td>
      <td>68631.0</td>
      <td>총 요금: 137,261</td>
      <td>4.55 (42)</td>
      <td>성산읍</td>
      <td>4.55</td>
      <td>42.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>서귀포시의 게스트용 별채</td>
      <td>하이재(돌집복층)제주돌집 큰나무가 보이는 집에서 힐링/고기국수집,카페도 오푼!</td>
      <td>154059.0</td>
      <td>총 요금: 308,118</td>
      <td>4.62 (116)</td>
      <td>성산읍</td>
      <td>4.62</td>
      <td>116.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>성산읍, 서귀포시의 펜션</td>
      <td>#365일2박10%할인#3박이상15%할인#개별테라스#일출봉뷰#예쁜숙소#레몬밤스테이#...</td>
      <td>70867.0</td>
      <td>총 요금: 141,734</td>
      <td>4.66 (29)</td>
      <td>성산읍</td>
      <td>4.66</td>
      <td>29.0</td>
    </tr>
  </tbody>
</table>
</div>



# 2. 결측치 파악


```python
print(air.isna().sum())
```

    name            0
    detail_info     0
    per_price       1
    total_price     0
    star_info      17
    region          0
    star           17
    star_count     17
    dtype: int64
    

별점에 대한 정보에서 17개의 데이터에서 결측치가 있음을 확인하였다.



```python
print(air['per_price'][air['per_price'].isnull()])

print(air.loc[3340])
air['per_price'][3340] = 365177/2
```

    3340   NaN
    Name: per_price, dtype: float64
    name           Udo-myeon, Cheju의 게스트용 별채
    detail_info         슬기로운 우도생활 (화이트 앤 골드)
    per_price                            NaN
    total_price                총 요금: 365,177
    star_info                      4.75 (40)
    region                               우도면
    star                                4.75
    star_count                          40.0
    Name: 3340, dtype: object
    

## 별점 결측치 제거


```python
air['star_info'][air['star_info'].isnull()]
```




    3319    NaN
    3320    NaN
    3322    NaN
    3324    NaN
    3325    NaN
    3327    NaN
    3334    NaN
    3335    NaN
    3347    NaN
    3353    NaN
    3356    NaN
    3359    NaN
    3363    NaN
    3366    NaN
    3367    NaN
    3373    NaN
    3375    NaN
    Name: star_info, dtype: object




```python
air.dropna(axis=0,how='any',inplace = True)
air
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>detail_info</th>
      <th>per_price</th>
      <th>total_price</th>
      <th>star_info</th>
      <th>region</th>
      <th>star</th>
      <th>star_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>표선면, 서귀포시의 집</td>
      <td>표선맨션 A301</td>
      <td>164330.0</td>
      <td>총 요금: 328,659</td>
      <td>4.64 (33)</td>
      <td>성산읍</td>
      <td>4.64</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>서귀포시의 개인실</td>
      <td>오조리비앤비,우도와 성산일출봉을 동시에 펜트하우스^^(301호)</td>
      <td>127241.0</td>
      <td>총 요금: 254,482</td>
      <td>4.69 (31)</td>
      <td>성산읍</td>
      <td>4.69</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Gujwa-eup, 특별자치도, Cheju의 펜션</td>
      <td>성산일출봉과 우도를 담은 오션뷰 애견동반펜션 - 14평 원룸(취사불가)</td>
      <td>68631.0</td>
      <td>총 요금: 137,261</td>
      <td>4.55 (42)</td>
      <td>성산읍</td>
      <td>4.55</td>
      <td>42.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>서귀포시의 게스트용 별채</td>
      <td>하이재(돌집복층)제주돌집 큰나무가 보이는 집에서 힐링/고기국수집,카페도 오푼!</td>
      <td>154059.0</td>
      <td>총 요금: 308,118</td>
      <td>4.62 (116)</td>
      <td>성산읍</td>
      <td>4.62</td>
      <td>116.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>성산읍, 서귀포시의 펜션</td>
      <td>#365일2박10%할인#3박이상15%할인#개별테라스#일출봉뷰#예쁜숙소#레몬밤스테이#...</td>
      <td>70867.0</td>
      <td>총 요금: 141,734</td>
      <td>4.66 (29)</td>
      <td>성산읍</td>
      <td>4.66</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3369</th>
      <td>제주시의 집</td>
      <td>우도우영팟민박 은 부모님께서 살아오셨던 이야기가 있는 전형적인 제주농가주택입니다.</td>
      <td>285295.0</td>
      <td>총 요금: 570,589</td>
      <td>4.9 (78)</td>
      <td>우도면</td>
      <td>4.90</td>
      <td>78.0</td>
    </tr>
    <tr>
      <th>3370</th>
      <td>Udo-myeon, Cheju의 펜션</td>
      <td>[우도 풀빌라]  프라이빗한 휴식 '서화우도'</td>
      <td>513530.0</td>
      <td>총 요금: 1,027,059</td>
      <td>5.0 (3)</td>
      <td>우도면</td>
      <td>5.00</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3371</th>
      <td>Udo-myeon, Cheju의 다인실</td>
      <td>노닐다펜션형민박民宿</td>
      <td>91294.0</td>
      <td>총 요금: 182,588</td>
      <td>4.5 (7)</td>
      <td>우도면</td>
      <td>4.50</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>3372</th>
      <td>Udo-myeon, Jeju-si의 호텔 객실</td>
      <td>우도고래펜션#3</td>
      <td>171177.0</td>
      <td>총 요금: 342,353</td>
      <td>4.81 (42)</td>
      <td>우도면</td>
      <td>4.81</td>
      <td>42.0</td>
    </tr>
    <tr>
      <th>3374</th>
      <td>Udo-myeon, Jeju-si의 펜션</td>
      <td>우도 진사민박201호</td>
      <td>119824.0</td>
      <td>총 요금: 239,647</td>
      <td>5.0 (4)</td>
      <td>우도면</td>
      <td>5.00</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
<p>3340 rows × 8 columns</p>
</div>



# 3. 이상치 확인


```python
import seaborn as sns
import matplotlib.pyplot as plt

fig, ax = plt.subplots(nrows = 2, ncols =2, figsize = (10,10))

sns.distplot(air['per_price'], ax= ax[0,0])
sns.distplot(air['star'],ax= ax[1,0])
sns.distplot(air['star_count'], ax= ax[0,1])
sns.distplot(air['star']*air['star_count'],ax=ax[1,1])
```


![graph1](/assets/images/airbnb_anal/output_12_2.png){: .align-center}
    
**<center>[그림 1] 각 변수들의 분포</center>**


## 이상치 제거

이상치를 제거하기 위해 IQR 이상치 제거법을 사용하기로 했다.
IQR 이상치 제거에 대한 함수를 미리 작성하여 사용하였다.

```python
import numpy as np

def outlier_iqr(data, column): 

    global lower, upper    
    
    q25, q75 = np.quantile(data[column], 0.25), np.quantile(data[column], 0.75)          
    
    iqr = q75 - q25    
    
    cut_off = iqr * 1.5          
    
    lower, upper = q25 - cut_off, q75 + cut_off     
    
    print('IQR은',iqr, '이다.')     
    print('lower bound 값은', lower, '이다.')     
    print('upper bound 값은', upper, '이다.')    
    
    data1 = data[data[column] > upper]     
    data2 = data[data[column] < lower]    
    
    return print('총 이상치 개수는', data1.shape[0] + data2.shape[0], '이다.')
```


```python
outlier_iqr(air,'per_price')
print('\n')
outlier_iqr(air,'star')
print('\n')
outlier_iqr(air,'star_count')
```

    IQR은 91295.0 이다.
    lower bound 값은 -45648.5 이다.
    upper bound 값은 319531.5 이다.
    총 이상치 개수는 96 이다.
    
    
    IQR은 0.1800000000000006 이다.
    lower bound 값은 4.489999999999998 이다.
    upper bound 값은 5.210000000000001 이다.
    총 이상치 개수는 116 이다.
    
    
    IQR은 109.0 이다.
    lower bound 값은 -136.5 이다.
    upper bound 값은 299.5 이다.
    총 이상치 개수는 100 이다.
    

## 요약값에 이상치 기준 추가


```python
des = air.describe()
```


```python
des.loc['q1 - 1.5*IQR'] = [-45648.5,4.489999999999998,-136.5]
des.loc['q3 + 1.5*IQR'] = [319531.5,5.210000000000001,299.5]
des
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>per_price</th>
      <th>star</th>
      <th>star_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>3340.000000</td>
      <td>3340.000000</td>
      <td>3340.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>146834.608234</td>
      <td>4.832228</td>
      <td>95.070958</td>
    </tr>
    <tr>
      <th>std</th>
      <td>73929.733024</td>
      <td>0.153572</td>
      <td>93.200181</td>
    </tr>
    <tr>
      <th>min</th>
      <td>28530.000000</td>
      <td>3.670000</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>91294.000000</td>
      <td>4.760000</td>
      <td>27.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>125530.000000</td>
      <td>4.870000</td>
      <td>68.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>182589.000000</td>
      <td>4.940000</td>
      <td>136.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>547765.000000</td>
      <td>5.000000</td>
      <td>1289.000000</td>
    </tr>
    <tr>
      <th>q1 - 1.5*IQR</th>
      <td>-45648.500000</td>
      <td>4.490000</td>
      <td>-136.500000</td>
    </tr>
    <tr>
      <th>q3 + 1.5*IQR</th>
      <td>319531.500000</td>
      <td>5.210000</td>
      <td>299.500000</td>
    </tr>
  </tbody>
</table>
</div>

각 변수에 대한 lower_bound와 upper_bound를 나타낸 표이다.


## 이상치 처리전 가격의 박스플랏


```python
sns.boxplot(air['per_price'])
```








    
![box1](/assets/images/airbnb_anal/output_20_1.png){: .align-center}    
    
**<center>[그림 2] 이상치 처리 전 price변수의 boxplot </center>**
    



```python
air = air[air['per_price'] < 319531.5]
air.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>per_price</th>
      <th>star</th>
      <th>star_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>3244.000000</td>
      <td>3244.000000</td>
      <td>3244.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>140205.094482</td>
      <td>4.829094</td>
      <td>95.557953</td>
    </tr>
    <tr>
      <th>std</th>
      <td>63437.954848</td>
      <td>0.154345</td>
      <td>92.733143</td>
    </tr>
    <tr>
      <th>min</th>
      <td>28530.000000</td>
      <td>3.670000</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>91294.000000</td>
      <td>4.760000</td>
      <td>27.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>125530.000000</td>
      <td>4.860000</td>
      <td>71.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>174030.000000</td>
      <td>4.940000</td>
      <td>137.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>319530.000000</td>
      <td>5.000000</td>
      <td>1289.000000</td>
    </tr>
  </tbody>
</table>
</div>



## 이상치 제거후


```python
sns.boxplot(air['per_price'])
```




    <AxesSubplot:>




    
![box2](/assets/images/airbnb_anal/output_23_1.png){: .align-center}    
    
**<center>[그림 3] 이상치 처리 후 price변수의 boxplot </center>**
    



```python
import seaborn as sns

air.head()

sns.distplot(air['per_price'])
# sns.distplot(air['star']*air['star_count'])
# sns.distplot(air['star_count'])
# sns.distplot(air['star'])
# (air['star'] * air['star_count']).describe()
```


    
![graph2](/assets/images/airbnb_anal/output_24_2.png){: .align-center}    
    
**<center>[그림 4] 이상치 처리 후 분포의 변화 </center>**
    

데이터 처리를 완료한 후 각 행정구역별로 데이터를 저장할 것이다.

# 4. 데이터 행정구역별로 나누기

데이터를 탐색하면서 각 데이터의 name에서 영문표기와 한글 표기에 지역을 나타내는 패턴이 있다는 것을 확인하여 해당 조건에 맞추어 코드를 작성하였다.

## 서귀포시

### (1) 성산읍


```python
df1 = pd.concat([air[air['name'].str.contains('Seongsan')],air[air['name'].str.contains('성산읍')]])

pd.concat([air[air['name'].str.contains('Seongsan')],air[air['name'].str.contains('성산읍')]]).describe()

num = []
for i in range(df1.shape[0]):
    num.append(i)

df1['index'] = num
df1.set_index('index',inplace=True)
df1

lable = []
for i in range(len(num)):
    lable.append(1)

df1['lable'] = lable
df1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>detail_info</th>
      <th>per_price</th>
      <th>total_price</th>
      <th>star_info</th>
      <th>region</th>
      <th>star</th>
      <th>star_count</th>
      <th>lable</th>
    </tr>
    <tr>
      <th>index</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Seongsan-eup, 특별자치도, Seogwipo의 콘도</td>
      <td># 동해바다전망콘도 @ 오션스타옆</td>
      <td>128953.0</td>
      <td>총 요금: 257,906</td>
      <td>4.42 (45)</td>
      <td>성산읍</td>
      <td>4.42</td>
      <td>45.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Seongsan-eup Seogwipo-si의 호텔 객실</td>
      <td>제주 성산일출봉의 일출 전망 빈필드하우스2  (팬션형bnb)</td>
      <td>148353.0</td>
      <td>총 요금: 296,706</td>
      <td>4.9 (324)</td>
      <td>성산읍</td>
      <td>4.90</td>
      <td>324.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Seongsan-eup Seogwipo-si의 호텔 객실</td>
      <td>제주 성산일출봉의 일출 전망 빈필드하우스2  (팬션형bnb)</td>
      <td>148353.0</td>
      <td>총 요금: 296,706</td>
      <td>4.9 (324)</td>
      <td>표선면</td>
      <td>4.90</td>
      <td>324.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>성산읍, 서귀포시의 펜션</td>
      <td>#365일2박10%할인#3박이상15%할인#개별테라스#일출봉뷰#예쁜숙소#레몬밤스테이#...</td>
      <td>70867.0</td>
      <td>총 요금: 141,734</td>
      <td>4.66 (29)</td>
      <td>성산읍</td>
      <td>4.66</td>
      <td>29.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>성산읍, 서귀포시의 펜션</td>
      <td>#365일2박10%할인#3박이상15%할인#개별테라스#일출봉뷰#예쁜숙소#레몬밤스테이#...</td>
      <td>70867.0</td>
      <td>총 요금: 141,734</td>
      <td>4.57 (21)</td>
      <td>성산읍</td>
      <td>4.57</td>
      <td>21.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>224</th>
      <td>성산읍, 서귀포시의 개인실</td>
      <td>제주 성산읍 시골마을의 조용한 숙소 누코지스테이 퀸베드룸 2인실</td>
      <td>104989.0</td>
      <td>총 요금: 209,977</td>
      <td>4.78 (67)</td>
      <td>구좌읍</td>
      <td>4.78</td>
      <td>67.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>225</th>
      <td>성산읍, 서귀포시의 개인실</td>
      <td>성산읍 조용한 시골마을의 트윈룸 누코지스테이 2인실</td>
      <td>104989.0</td>
      <td>총 요금: 209,977</td>
      <td>4.81 (108)</td>
      <td>구좌읍</td>
      <td>4.81</td>
      <td>108.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>226</th>
      <td>성산읍, 서귀포시의 개인실</td>
      <td>성산읍 고즈넉하고 조용한마을 누코지스테이 퀸베드룸2인실</td>
      <td>106130.0</td>
      <td>총 요금: 212,259</td>
      <td>4.78 (167)</td>
      <td>구좌읍</td>
      <td>4.78</td>
      <td>167.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>227</th>
      <td>성산읍, 서귀포시의 농장 체험 숙소</td>
      <td>스테이 수산_올레</td>
      <td>169465.0</td>
      <td>총 요금: 338,930</td>
      <td>4.87 (62)</td>
      <td>구좌읍</td>
      <td>4.87</td>
      <td>62.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>228</th>
      <td>성산읍, 서귀포시의 펜션</td>
      <td>제주 동부 성산일출봉 감성 가득 세오니네민박2</td>
      <td>87871.0</td>
      <td>총 요금: 175,741</td>
      <td>4.76 (180)</td>
      <td>구좌읍</td>
      <td>4.76</td>
      <td>180.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>229 rows × 9 columns</p>
</div>



### (2) 표선면


```python
df2 = pd.concat([air[air['name'].str.contains('Pyoseon')],air[air['name'].str.contains('표선면')]])
pd.concat([air[air['name'].str.contains('Pyoseon')],air[air['name'].str.contains('표선면')]]).describe()

num = []
for i in range(df2.shape[0]):
    num.append(i)

df2['index'] = num
df2.set_index('index',inplace=True)

lable = []
for i in range(len(num)):
    lable.append(2)

df2['lable'] = lable
```

### (3) 남원읍


```python
df3 = pd.concat([air[air['name'].str.contains('Namwon')],air[air['name'].str.contains('남원읍')]])

pd.concat([air[air['name'].str.contains('Namwon')],air[air['name'].str.contains('남원읍')]]).describe()

num = []
for i in range(df3.shape[0]):
    num.append(i)

df3['index'] = num
df3.set_index('index',inplace=True)


lable = []
for i in range(len(num)):
    lable.append(3)

df3['lable'] = lable
```

### (4) 서귀포시(중문동 포함)


```python
df4 = air[((air['name'].str.contains('서귀포시')) ^ (air['name'].str.contains('Seogwipo-si'))) & ~air['name'].str.contains('면') & ~air['name'].str.contains('읍') & ~air['name'].str.contains('eup') & ~air['name'].str.contains('myeon')] 
df4 = pd.concat([air[air['name'].str.contains('Jungmun')],air[air['name'].str.contains('중문동')]])

num = []
for i in range(df4.shape[0]):
    num.append(i)

df4['index'] = num
df4.set_index('index',inplace=True)

lable = []
for i in range(len(num)):
    lable.append(4)

df4['lable'] = lable
```

### (5) 안덕면


```python
df5 = pd.concat([air[air['name'].str.contains('Andeok')],air[air['name'].str.contains('안덕면')]])

num = []
for i in range(df5.shape[0]):
    num.append(i)

df5['index'] = num
df5.set_index('index',inplace=True)


lable = []
for i in range(len(num)):
    lable.append(5)

df5['lable'] = lable
```

### (6) 대정읍


```python
df6 = pd.concat([air[air['name'].str.contains('Daejeong')],air[air['name'].str.contains('대정읍')]])

num = []
for i in range(df6.shape[0]):
    num.append(i)

df6['index'] = num
df6.set_index('index',inplace=True)


lable = []
for i in range(len(num)):
    lable.append(6)

df6['lable'] = lable
```


```python
pd.concat([air[air['name'].str.contains('Daejeong')],air[air['name'].str.contains('대정읍')]]).shape
```




    (52, 8)



## 제주시

### (1) 한경면


```python
df7 = pd.concat([air[air['name'].str.contains('Hangyeong')],air[air['name'].str.contains('한경면')]])

num = []
for i in range(df7.shape[0]):
    num.append(i)

df7['index'] = num
df7.set_index('index',inplace=True)


lable = []
for i in range(len(num)):
    lable.append(7)

df7['lable'] = lable
```

### (2) 한림읍


```python
df8 = pd.concat([air[air['name'].str.contains('Hallim')],air[air['name'].str.contains('한림읍')]])

num = []
for i in range(df8.shape[0]):
    num.append(i)

df8['index'] = num
df8.set_index('index',inplace=True)


lable = []
for i in range(len(num)):
    lable.append(8)

df8['lable'] = lable
```

### (3) 애월읍


```python
df9 = pd.concat([air[air['name'].str.contains('Aewol')],air[air['name'].str.contains('애월읍')]])

num = []
for i in range(df9.shape[0]):
    num.append(i)

df9['index'] = num
df9.set_index('index',inplace=True)


lable = []
for i in range(len(num)):
    lable.append(9)

df9['lable'] = lable
```

### (4) 조천읍


```python
df10 = air[air['name'].str.contains('조천읍' , 'Jochon')]

num = []
for i in range(df10.shape[0]):
    num.append(i)

df10['index'] = num
df10.set_index('index',inplace=True)


lable = []
for i in range(len(num)):
    lable.append(10)

df10['lable'] = lable
```

    

### (5) 구좌읍


```python
df11 = pd.concat([air[air['name'].str.contains('Gujwa')],air[air['name'].str.contains('구좌읍')]])

num = []
for i in range(df11.shape[0]):
    num.append(i)

df11['index'] = num
df11.set_index('index',inplace=True)


lable = []
for i in range(len(num)):
    lable.append(11)

df11['lable'] = lable
```

### (6) 제주시


```python
#제주시
df12 = air[((air['name'].str.contains('제주시')) ^ (air['name'].str.contains('Jeju-si')) ^ (air['name'].str.contains('Cheju'))) & ~air['name'].str.contains('면') & ~air['name'].str.contains('읍') & ~air['name'].str.contains('eup') & ~air['name'].str.contains('myeon')] 

num = []
for i in range(df12.shape[0]):
    num.append(i)

df12['index'] = num
df12.set_index('index',inplace=True)
lable = []
for i in range(len(num)):
    lable.append(12)


df12['lable'] = lable
df12
```

    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>detail_info</th>
      <th>per_price</th>
      <th>total_price</th>
      <th>star_info</th>
      <th>region</th>
      <th>star</th>
      <th>star_count</th>
      <th>lable</th>
    </tr>
    <tr>
      <th>index</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>제주시의 개인실</td>
      <td>세화돌집 바깥채(독채) - 침실과 거실, 부엌과 욕실이 구분되어 있어 여유로움.</td>
      <td>108413.0</td>
      <td>총 요금: 216,826</td>
      <td>4.97 (33)</td>
      <td>성산읍</td>
      <td>4.97</td>
      <td>33.0</td>
      <td>12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>제주시의 호텔 객실</td>
      <td>천년비자 펜션 201호/ 제주 힐링숲 비자림 입구 / 연인 가족실  2~5인 먼 바다전망</td>
      <td>81201.0</td>
      <td>총 요금: 162,401</td>
      <td>4.82 (211)</td>
      <td>성산읍</td>
      <td>4.82</td>
      <td>211.0</td>
      <td>12</td>
    </tr>
    <tr>
      <th>2</th>
      <td>제주시의 집</td>
      <td>빔프로젝트가 있는 하도리 독채민박 하늘을달리다 - 앞집[1-2인전용]</td>
      <td>66189.0</td>
      <td>총 요금: 132,377</td>
      <td>4.55 (263)</td>
      <td>성산읍</td>
      <td>4.55</td>
      <td>263.0</td>
      <td>12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>제주시의 호텔 객실</td>
      <td>천년비자 펜션 302호 / 제주 힐링숲 비자림 입구/ 연인 가족실  2~4인/ 한라...</td>
      <td>81201.0</td>
      <td>총 요금: 162,401</td>
      <td>4.81 (229)</td>
      <td>성산읍</td>
      <td>4.81</td>
      <td>229.0</td>
      <td>12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>제주시 의 호텔 객실</td>
      <td>천년비자 펜션 301호 / 제주 힐링숲 비자림 입구 / 연인 가족실 2~4인 먼 바다전망</td>
      <td>81201.0</td>
      <td>총 요금: 162,401</td>
      <td>4.82 (262)</td>
      <td>성산읍</td>
      <td>4.82</td>
      <td>262.0</td>
      <td>12</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>535</th>
      <td>제주시의 전원주택</td>
      <td>스테이희도[喜島]_공간.희 : \r\n제주동쪽 예쁜 돌담길 따라 고즈넉한 옛집</td>
      <td>205412.0</td>
      <td>총 요금: 410,824</td>
      <td>5.0 (6)</td>
      <td>구좌읍</td>
      <td>5.00</td>
      <td>6.0</td>
      <td>12</td>
    </tr>
    <tr>
      <th>536</th>
      <td>제주시의 집</td>
      <td>세화리 배목수 두번째집 '먹구슬나무가 멋있는집'</td>
      <td>159765.0</td>
      <td>총 요금: 319,530</td>
      <td>4.92 (145)</td>
      <td>구좌읍</td>
      <td>4.92</td>
      <td>145.0</td>
      <td>12</td>
    </tr>
    <tr>
      <th>537</th>
      <td>제주시의 게스트용 별채</td>
      <td>제주도 월정리 바다가 보이는 2인전용 독채</td>
      <td>148353.0</td>
      <td>총 요금: 296,706</td>
      <td>4.83 (230)</td>
      <td>구좌읍</td>
      <td>4.83</td>
      <td>230.0</td>
      <td>12</td>
    </tr>
    <tr>
      <th>538</th>
      <td>제주시의 게스트용 별채</td>
      <td>우도돌담길민박 바깥채(원룸형)</td>
      <td>136941.0</td>
      <td>총 요금: 273,882</td>
      <td>4.83 (225)</td>
      <td>우도면</td>
      <td>4.83</td>
      <td>225.0</td>
      <td>12</td>
    </tr>
    <tr>
      <th>539</th>
      <td>제주시의 집</td>
      <td>우도우영팟민박 은 부모님께서 살아오셨던 이야기가 있는 전형적인 제주농가주택입니다.</td>
      <td>285295.0</td>
      <td>총 요금: 570,589</td>
      <td>4.9 (78)</td>
      <td>우도면</td>
      <td>4.90</td>
      <td>78.0</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
<p>540 rows × 9 columns</p>
</div>



### (7) 우도면


```python
#우도면
df13 = pd.concat([air[air['name'].str.contains('Udo')],air[air['name'].str.contains('우도')]])

num = []
for i in range(df13.shape[0]):
    num.append(i)

df13['index'] = num
df13.set_index('index',inplace=True)


lable = []
for i in range(len(num)):
    lable.append(13)

df13['lable'] = lable
```


```python
pd.concat([air[air['name'].str.contains('Udo')],air[air['name'].str.contains('우도')]]).shape
```




    (33, 8)



# 5. 전처리 결과
* 3,340개의 대이터중 3,264개의 데이터만 출력됨
* 나머지 76개 데이터는 지역 명이 나오지 않음
* ex) KR의 개인실 

# 6. 숙소의 다른 특성 파악

행정구역의 특징을 분석하기 위해 행정구역을 분류할 수 있는 여러 변수를 추가해보았다.


## 루프탑이 있는 숙소

```python
air[air['detail_info'].str.contains('루프탑')]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>detail_info</th>
      <th>per_price</th>
      <th>total_price</th>
      <th>star_info</th>
      <th>region</th>
      <th>star</th>
      <th>star_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>803</th>
      <td>Hogeun-dong, Seogwipo-si의 집</td>
      <td>퍼머넌트베케이션×솔루나 L4 : Room 302 오션뷰 루프탑테라스</td>
      <td>171177.0</td>
      <td>총 요금: 342,353</td>
      <td>4.54 (37)</td>
      <td>남원읍</td>
      <td>4.54</td>
      <td>37.0</td>
    </tr>
    <tr>
      <th>954</th>
      <td>Hogeun-dong, Seogwipo-si의 집</td>
      <td>퍼머넌트베케이션×솔루나 L4 : Room 302 오션뷰 루프탑테라스</td>
      <td>171177.0</td>
      <td>총 요금: 342,353</td>
      <td>4.54 (37)</td>
      <td>중문동</td>
      <td>4.54</td>
      <td>37.0</td>
    </tr>
    <tr>
      <th>1033</th>
      <td>Seogwipo-si의 호텔 객실</td>
      <td>프리미엄룸  # 모던 심플한 인테리어, 오픈바스,최고 오션뷰의 루프탑</td>
      <td>215226.0</td>
      <td>총 요금: 430,452</td>
      <td>4.83 (146)</td>
      <td>중문동</td>
      <td>4.83</td>
      <td>146.0</td>
    </tr>
    <tr>
      <th>1389</th>
      <td>제주시의 개인실</td>
      <td>(노을맛집. 루프탑. 자쿠지) 신창윤업사 201호(연박할인)</td>
      <td>141734.0</td>
      <td>총 요금: 283,468</td>
      <td>4.88 (304)</td>
      <td>대정읍</td>
      <td>4.88</td>
      <td>304.0</td>
    </tr>
    <tr>
      <th>1643</th>
      <td>제주시의 개인실</td>
      <td>인제주 Here 정원뷰.넷플릭스.조식.루프탑</td>
      <td>99283.0</td>
      <td>총 요금: 198,565</td>
      <td>4.53 (59)</td>
      <td>한경면</td>
      <td>4.53</td>
      <td>59.0</td>
    </tr>
    <tr>
      <th>1811</th>
      <td>한림읍, 제주시의 개인실</td>
      <td>인제주 Now 정원뷰.넷플릭스.조식.루프탑</td>
      <td>99283.0</td>
      <td>총 요금: 198,565</td>
      <td>4.63 (123)</td>
      <td>한경면</td>
      <td>4.63</td>
      <td>123.0</td>
    </tr>
    <tr>
      <th>1868</th>
      <td>Hangyeong-myeon, Cheju의 개인실</td>
      <td>[노을맛집. 멋진루프탑] 신창윤업사 102호 (연박 할인)</td>
      <td>163303.0</td>
      <td>총 요금: 326,605</td>
      <td>4.96 (225)</td>
      <td>한경면</td>
      <td>4.96</td>
      <td>225.0</td>
    </tr>
    <tr>
      <th>1888</th>
      <td>제주시의 개인실</td>
      <td>(노을맛집. 루프탑. 자쿠지) 신창윤업사 201호(연박할인)</td>
      <td>141734.0</td>
      <td>총 요금: 283,468</td>
      <td>4.88 (304)</td>
      <td>한경면</td>
      <td>4.88</td>
      <td>304.0</td>
    </tr>
    <tr>
      <th>2065</th>
      <td>Hangyeong-myeon, Cheju의 개인실</td>
      <td>[노을맛집. 멋진루프탑] 신창윤업사 102호 (연박 할인)</td>
      <td>163303.0</td>
      <td>총 요금: 326,605</td>
      <td>4.96 (225)</td>
      <td>한림읍</td>
      <td>4.96</td>
      <td>225.0</td>
    </tr>
    <tr>
      <th>2096</th>
      <td>한림읍, 제주시의 개인실</td>
      <td>인제주 Now 정원뷰.넷플릭스.조식.루프탑</td>
      <td>99283.0</td>
      <td>총 요금: 198,565</td>
      <td>4.63 (123)</td>
      <td>한림읍</td>
      <td>4.63</td>
      <td>123.0</td>
    </tr>
    <tr>
      <th>2140</th>
      <td>제주시의 개인실</td>
      <td>(노을맛집. 루프탑. 자쿠지) 신창윤업사 201호(연박할인)</td>
      <td>141734.0</td>
      <td>총 요금: 283,468</td>
      <td>4.88 (304)</td>
      <td>한림읍</td>
      <td>4.88</td>
      <td>304.0</td>
    </tr>
    <tr>
      <th>2923</th>
      <td>구좌읍, 제주시의 전원주택</td>
      <td>제주 중산간에 위치한 오두막st 루프탑 있는 오롯한집 201</td>
      <td>148353.0</td>
      <td>총 요금: 296,706</td>
      <td>4.9 (83)</td>
      <td>조천읍</td>
      <td>4.90</td>
      <td>83.0</td>
    </tr>
    <tr>
      <th>2927</th>
      <td>조천읍, 제주시의 게스트용 별채</td>
      <td>(신흥부부B동) 신흥해변 앞 단독사용 루프탑(바베큐),자쿠지 독채숙소</td>
      <td>227094.0</td>
      <td>총 요금: 454,188</td>
      <td>4.67 (21)</td>
      <td>조천읍</td>
      <td>4.67</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>2969</th>
      <td>조천읍, 제주시의 전원주택</td>
      <td>달빛 제주옥상달빛 \r\n프라이빗한 달빛 \r\n통창뷰/루프탑\r\n22년8월신축건물</td>
      <td>194000.0</td>
      <td>총 요금: 388,000</td>
      <td>5.0 (13)</td>
      <td>조천읍</td>
      <td>5.00</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>3020</th>
      <td>조천읍, 제주시의 전원주택</td>
      <td>별빛 제주옥상달빛 \r\n프라이빗 별빛/통창뷰/루프탑\r\n22년8월신축건물</td>
      <td>148353.0</td>
      <td>총 요금: 296,706</td>
      <td>5.0 (13)</td>
      <td>조천읍</td>
      <td>5.00</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>3114</th>
      <td>구좌읍, 제주시의 전원주택</td>
      <td>제주 중산간에 위치한 오두막st 루프탑 있는 오롯한집 201</td>
      <td>148353.0</td>
      <td>총 요금: 296,706</td>
      <td>4.9 (83)</td>
      <td>구좌읍</td>
      <td>4.90</td>
      <td>83.0</td>
    </tr>
  </tbody>
</table>
</div>



## 가격 카테고리화


```python
for i in range(1,14):
      globals()['df'+str(i)+'_price1'] = 0
      globals()['df'+str(i)+'_price2'] = 0
      globals()['df'+str(i)+'_price3'] = 0
      globals()['df'+str(i)+'_price4'] = 0
      globals()['pr'+str(i)+'_price1'] = 0
      globals()['pr'+str(i)+'_price2'] = 0
      globals()['pr'+str(i)+'_price3'] = 0
      globals()['pr'+str(i)+'_price4'] = 0
      globals()['mean'+str(i)+'_price1'] = 0
      globals()['mean'+str(i)+'_price2'] = 0
      globals()['mean'+str(i)+'_price3'] = 0
      globals()['mean'+str(i)+'_price4'] = 0
      globals()['price1_star'+str(i)] = 0
      globals()['price2_star'+str(i)] = 0
      globals()['price3_star'+str(i)] = 0
      globals()['price4_star'+str(i)] = 0
      globals()['price1_star_mean'+str(i)] = 0
      globals()['price2_star_mean'+str(i)] = 0
      globals()['price3_star_mean'+str(i)] = 0
      globals()['price4_star_mean'+str(i)] = 0
      globals()['price1_review'+str(i)] = 0
      globals()['price2_review'+str(i)] = 0
      globals()['price3_review'+str(i)] = 0
      globals()['price4_review'+str(i)] = 0
      globals()['price1_review_mean'+str(i)] = 0
      globals()['price2_review_mean'+str(i)] = 0
      globals()['price3_review_mean'+str(i)] = 0
      globals()['price4_review_mean'+str(i)] = 0      
      

for i in range(1,14):    
    for j in range(globals()['df'+str(i)].shape[0]):
        if globals()['df'+str(i)]['per_price'][j] < 91294:
            globals()['df'+str(i)+'_price1'] += 1
            globals()['pr'+str(i)+'_price1'] += globals()['df'+str(i)]['per_price'][j]
            globals()['price1_star'+str(i)] += globals()['df'+str(i)]['star'][j]
            globals()['price1_review'+str(i)] += globals()['df'+str(i)]['star_count'][j]
        elif globals()['df'+str(i)]['per_price'][j] < 125530:
            globals()['df'+str(i)+'_price2'] += 1
            globals()['pr'+str(i)+'_price2'] += globals()['df'+str(i)]['per_price'][j]
            globals()['price2_star'+str(i)] += globals()['df'+str(i)]['star'][j]
            globals()['price2_review'+str(i)] += globals()['df'+str(i)]['star_count'][j]
        elif globals()['df'+str(i)]['per_price'][j] < 174030:
            globals()['df'+str(i)+'_price3'] += 1
            globals()['pr'+str(i)+'_price3'] += globals()['df'+str(i)]['per_price'][j]
            globals()['price3_star'+str(i)] += globals()['df'+str(i)]['star'][j]
            globals()['price3_review'+str(i)] += globals()['df'+str(i)]['star_count'][j]
        else:
            globals()['df'+str(i)+'_price4'] += 1
            globals()['pr'+str(i)+'_price4'] += globals()['df'+str(i)]['per_price'][j]
            globals()['price4_star'+str(i)] += globals()['df'+str(i)]['star'][j]
            globals()['price4_review'+str(i)] += globals()['df'+str(i)]['star_count'][j]
    
    globals()['mean'+str(i)+'_price1'] = globals()['pr'+str(i)+'_price1']/globals()['df'+str(i)+'_price1']
    globals()['mean'+str(i)+'_price2'] = globals()['pr'+str(i)+'_price2']/globals()['df'+str(i)+'_price2']
    globals()['mean'+str(i)+'_price3'] = globals()['pr'+str(i)+'_price3']/globals()['df'+str(i)+'_price3']
    globals()['price1_star_mean'+str(i)] = globals()['price1_star'+str(i)]/globals()['df'+str(i)+'_price1']
    globals()['price2_star_mean'+str(i)] = globals()['price2_star'+str(i)]/globals()['df'+str(i)+'_price2']
    globals()['price3_star_mean'+str(i)] = globals()['price3_star'+str(i)]/globals()['df'+str(i)+'_price3']
    globals()['price1_review_mean'+str(i)] = globals()['price1_review'+str(i)]/globals()['df'+str(i)+'_price1']
    globals()['price2_review_mean'+str(i)] = globals()['price2_review'+str(i)]/globals()['df'+str(i)+'_price2']
    globals()['price3_review_mean'+str(i)] = globals()['price3_review'+str(i)]/globals()['df'+str(i)+'_price3']

for i in range(1,14):    
    globals()['mean'+str(i)+'_price4'] = globals()['pr'+str(i)+'_price4']/globals()['df'+str(i)+'_price4']
    globals()['price4_review_mean'+str(i)] = globals()['price4_review'+str(i)]/globals()['df'+str(i)+'_price4']
    globals()['price4_star_mean'+str(i)] = globals()['price4_star'+str(i)]/globals()['df'+str(i)+'_price4']
```

## 평균 별점 이상인 숙소 필터링

여행객들이 별점이 낮은 곳은 방문을 피할 것이라고 판단하여 필터링하였다.


```python
for i in range(1,14):
      globals()['star_df'+str(i)+'_price1'] = 0
      globals()['star_df'+str(i)+'_price2'] = 0
      globals()['star_df'+str(i)+'_price3'] = 0
      globals()['star_df'+str(i)+'_price4'] = 0
      globals()['star_pr'+str(i)+'_price1'] = 0
      globals()['star_pr'+str(i)+'_price2'] = 0
      globals()['star_pr'+str(i)+'_price3'] = 0
      globals()['star_pr'+str(i)+'_price4'] = 0
      globals()['star_mean'+str(i)+'_price1'] = 0
      globals()['star_mean'+str(i)+'_price2'] = 0
      globals()['star_mean'+str(i)+'_price3'] = 0
      globals()['star_mean'+str(i)+'_price4'] = 0
      globals()['star_price1_star'+str(i)] = 0
      globals()['star_price2_star'+str(i)] = 0
      globals()['star_price3_star'+str(i)] = 0
      globals()['star_price4_star'+str(i)] = 0
      globals()['star_price1_star_mean'+str(i)] = 0
      globals()['star_price2_star_mean'+str(i)] = 0
      globals()['star_price3_star_mean'+str(i)] = 0
      globals()['star_price4_star_mean'+str(i)] = 0
      globals()['star_price1_review'+str(i)] = 0
      globals()['star_price2_review'+str(i)] = 0
      globals()['star_price3_review'+str(i)] = 0
      globals()['star_price4_review'+str(i)] = 0
      globals()['star_price1_review_mean'+str(i)] = 0
      globals()['star_price2_review_mean'+str(i)] = 0
      globals()['star_price3_review_mean'+str(i)] = 0
      globals()['star_price4_review_mean'+str(i)] = 0      
      
      
      
        
for i in range(1,14):    
    for j in range(globals()['df'+str(i)].shape[0]):
        if globals()['df'+str(i)]['star'][j] > air.star.mean():
            if globals()['df'+str(i)]['per_price'][j] < 91294:
                globals()['star_df'+str(i)+'_price1'] += 1
                globals()['star_pr'+str(i)+'_price1'] += globals()['df'+str(i)]['per_price'][j]
                globals()['star_price1_star'+str(i)] += globals()['df'+str(i)]['star'][j]
                globals()['star_price1_review'+str(i)] += globals()['df'+str(i)]['star_count'][j]
            elif globals()['df'+str(i)]['per_price'][j] < 125530:
                globals()['star_df'+str(i)+'_price2'] += 1
                globals()['star_pr'+str(i)+'_price2'] += globals()['df'+str(i)]['per_price'][j]
                globals()['star_price2_star'+str(i)] += globals()['df'+str(i)]['star'][j]
                globals()['star_price2_review'+str(i)] += globals()['df'+str(i)]['star_count'][j]
            elif globals()['df'+str(i)]['per_price'][j] < 174030:
                globals()['star_df'+str(i)+'_price3'] += 1
                globals()['star_pr'+str(i)+'_price3'] += globals()['df'+str(i)]['per_price'][j]
                globals()['star_price3_star'+str(i)] += globals()['df'+str(i)]['star'][j]
                globals()['star_price3_review'+str(i)] += globals()['df'+str(i)]['star_count'][j]
            else:
                globals()['star_df'+str(i)+'_price4'] += 1
                globals()['star_pr'+str(i)+'_price4'] += globals()['df'+str(i)]['per_price'][j]
                globals()['star_price4_star'+str(i)] += globals()['df'+str(i)]['star'][j]
                globals()['star_price4_review'+str(i)] += globals()['df'+str(i)]['star_count'][j]
            
                
    globals()['star_mean'+str(i)+'_price1'] = globals()['star_pr'+str(i)+'_price1']/globals()['star_df'+str(i)+'_price1']
    globals()['star_mean'+str(i)+'_price2'] = globals()['star_pr'+str(i)+'_price2']/globals()['star_df'+str(i)+'_price2']
    globals()['star_price1_star_mean'+str(i)] = globals()['star_price1_star'+str(i)]/globals()['star_df'+str(i)+'_price1']
    globals()['star_price2_star_mean'+str(i)] = globals()['star_price2_star'+str(i)]/globals()['star_df'+str(i)+'_price2']
    globals()['star_price1_review_mean'+str(i)] = globals()['star_price1_review'+str(i)]/globals()['star_df'+str(i)+'_price1']
    globals()['star_price2_review_mean'+str(i)] = globals()['star_price2_review'+str(i)]/globals()['star_df'+str(i)+'_price2']
    
for i in range(1,13):
    globals()['star_mean'+str(i)+'_price3'] = globals()['star_pr'+str(i)+'_price3']/globals()['star_df'+str(i)+'_price3']
    globals()['star_price3_star_mean'+str(i)] = globals()['star_price3_star'+str(i)]/globals()['star_df'+str(i)+'_price3']
    globals()['star_price3_review_mean'+str(i)] = globals()['star_price3_review'+str(i)]/globals()['star_df'+str(i)+'_price3']

    
      
for i in range(1,14):    
    globals()['star_mean'+str(i)+'_price4'] = globals()['star_pr'+str(i)+'_price4']/globals()['star_df'+str(i)+'_price4']
    globals()['star_price4_star_mean'+str(i)] = globals()['star_price4_star'+str(i)]/globals()['star_df'+str(i)+'_price4']
    globals()['star_price4_review_mean'+str(i)] = globals()['star_price4_review'+str(i)]/globals()['star_df'+str(i)+'_price4']
    
      
    
```


```python
(air['star'] * air['star_count']).median()
```




    339.84



## 가중 별점 만들기

숙소에 평점이 높은 곳이라도 방문자들의 평점 참여수가 적다면 좋은 숙소라고 판단하기 어렵기 떄문에 이 두 변수를 곱하여 새로운 가중 별점이라는 변수를 생성하였다.


```python
((df1['star'] * df1['star_count']).sum())/df1.shape[0]

air['star']
for i in range(1,14):
    for j in range(globals()['df'+str(i)].shape[0]):
        globals()['weight_star'+str(i)] = ((globals()['df'+str(i)]['star'] * globals()['df'+str(i)]['star_count']).sum())/globals()['df'+str(i)].shape[0]
        
for i in range(1,14):
      globals()['wstar_df'+str(i)+'_price1'] = 0
      globals()['wstar_df'+str(i)+'_price2'] = 0
      globals()['wstar_df'+str(i)+'_price3'] = 0
      globals()['wstar_df'+str(i)+'_price4'] = 0
      globals()['wstar_pr'+str(i)+'_price1'] = 0
      globals()['wstar_pr'+str(i)+'_price2'] = 0
      globals()['wstar_pr'+str(i)+'_price3'] = 0
      globals()['wstar_pr'+str(i)+'_price4'] = 0
      globals()['wstar_mean'+str(i)+'_price1'] = 0
      globals()['wstar_mean'+str(i)+'_price2'] = 0
      globals()['wstar_mean'+str(i)+'_price3'] = 0
      globals()['wstar_mean'+str(i)+'_price4'] = 0
      globals()['wstar_price1_star'+str(i)] = 0
      globals()['wstar_price2_star'+str(i)] = 0
      globals()['wstar_price3_star'+str(i)] = 0
      globals()['wstar_price4_star'+str(i)] = 0
      globals()['wstar_price1_star_mean'+str(i)] = 0
      globals()['wstar_price2_star_mean'+str(i)] = 0
      globals()['wstar_price3_star_mean'+str(i)] = 0
      globals()['wstar_price4_star_mean'+str(i)] = 0
      globals()['wstar_price1_review'+str(i)] = 0
      globals()['wstar_price2_review'+str(i)] = 0
      globals()['wstar_price3_review'+str(i)] = 0
      globals()['wstar_price4_review'+str(i)] = 0
      globals()['wstar_price1_review_mean'+str(i)] = 0
      globals()['wstar_price2_review_mean'+str(i)] = 0
      globals()['wstar_price3_review_mean'+str(i)] = 0
      globals()['wstar_price4_review_mean'+str(i)] = 0
      
    
    
for i in range(1,14):    
    for j in range(globals()['df'+str(i)].shape[0]):
        if globals()['df'+str(i)]['star'][j] * globals()['df'+str(i)]['star_count'][j] > (air['star'] * air['star_count']).median():
            if globals()['df'+str(i)]['per_price'][j] < 91294:
                globals()['wstar_df'+str(i)+'_price1'] += 1
                globals()['wstar_pr'+str(i)+'_price1'] += globals()['df'+str(i)]['per_price'][j]
                globals()['wstar_price1_star'+str(i)] += globals()['df'+str(i)]['star'][j]
                globals()['wstar_price1_review'+str(i)] += globals()['df'+str(i)]['star_count'][j]
            elif globals()['df'+str(i)]['per_price'][j] < 125530:
                globals()['wstar_df'+str(i)+'_price2'] += 1
                globals()['wstar_pr'+str(i)+'_price2'] += globals()['df'+str(i)]['per_price'][j]
                globals()['wstar_price2_star'+str(i)] += globals()['df'+str(i)]['star'][j]
                globals()['wstar_price2_review'+str(i)] += globals()['df'+str(i)]['star_count'][j]
            elif globals()['df'+str(i)]['per_price'][j] < 174030:
                globals()['wstar_df'+str(i)+'_price3'] += 1
                globals()['wstar_pr'+str(i)+'_price3'] += globals()['df'+str(i)]['per_price'][j]
                globals()['wstar_price3_star'+str(i)] += globals()['df'+str(i)]['star'][j]
                globals()['wstar_price3_review'+str(i)] += globals()['df'+str(i)]['star_count'][j]
            else:
                globals()['wstar_df'+str(i)+'_price4'] += 1
                globals()['wstar_pr'+str(i)+'_price4'] += globals()['df'+str(i)]['per_price'][j]
                globals()['wstar_price4_star'+str(i)] += globals()['df'+str(i)]['star'][j]
                globals()['wstar_price4_review'+str(i)] += globals()['df'+str(i)]['star_count'][j]
                
    globals()['wstar_mean'+str(i)+'_price3'] = globals()['wstar_pr'+str(i)+'_price3']/globals()['wstar_df'+str(i)+'_price3']
    globals()['wstar_price3_star_mean'+str(i)] = globals()['wstar_price3_star'+str(i)]/globals()['wstar_df'+str(i)+'_price3']
    globals()['wstar_price3_review_mean'+str(i)] = globals()['wstar_price3_review'+str(i)]/globals()['wstar_df'+str(i)+'_price3']
    
    
    globals()['wstar_mean'+str(i)+'_price4'] = globals()['wstar_pr'+str(i)+'_price4']/globals()['wstar_df'+str(i)+'_price4']
    globals()['wstar_price4_star_mean'+str(i)] = globals()['wstar_price4_star'+str(i)]/globals()['wstar_df'+str(i)+'_price4']
    globals()['wstar_price4_review_mean'+str(i)] = globals()['wstar_price4_review'+str(i)]/globals()['wstar_df'+str(i)+'_price4']

for i in range(1,13):    
    globals()['wstar_mean'+str(i)+'_price1'] = globals()['wstar_pr'+str(i)+'_price1']/globals()['wstar_df'+str(i)+'_price1']
    globals()['wstar_price1_star_mean'+str(i)] = globals()['wstar_price1_star'+str(i)]/globals()['wstar_df'+str(i)+'_price1']
    globals()['wstar_price1_review_mean'+str(i)] = globals()['wstar_price1_review'+str(i)]/globals()['df'+str(i)+'_price1']


for i in range(1,6):    
    globals()['wstar_mean'+str(i)+'_price2'] = globals()['wstar_pr'+str(i)+'_price2']/globals()['wstar_df'+str(i)+'_price2']
    globals()['wstar_price2_review_mean'+str(i)] = globals()['wstar_price2_review'+str(i)]/globals()['wstar_df'+str(i)+'_price2']
    globals()['wstar_price2_star_mean'+str(i)] = globals()['wstar_price2_star'+str(i)]/globals()['wstar_df'+str(i)+'_price2']

for i in range(7,13):    
    globals()['wstar_mean'+str(i)+'_price2'] = globals()['wstar_pr'+str(i)+'_price2']/globals()['wstar_df'+str(i)+'_price2']
    globals()['wstar_price2_review_mean'+str(i)] = globals()['wstar_price2_review'+str(i)]/globals()['wstar_df'+str(i)+'_price2']
    globals()['wstar_price2_star_mean'+str(i)] = globals()['wstar_price2_star'+str(i)]/globals()['wstar_df'+str(i)+'_price2']
```


```python
for i in range(1,14):
      globals()['price1_star'+str(i)] = 0
      globals()['price2_star'+str(i)] = 0
      globals()['price3_star'+str(i)] = 0
      globals()['price4_star'+str(i)] = 0
```


```python
for i in range(1,14):
    globals()['wstar_count'+str(i)] = 0
      
for i in range(1,14):    
    for j in range(globals()['df'+str(i)].shape[0]):
        if globals()['df'+str(i)]['star'][j] * globals()['df'+str(i)]['star_count'][j] > (air['star'] * air['star_count']).median():
            globals()['wstar_count'+str(i)] += 1

```

# 행정 구역별 평균치

생성한 변수들과 기존에 존재했던 변수들의 행정 구역별 평균을 데이터프레임으로 정리하였다.


```python
area = pd.DataFrame()
area['area'] = ['성산읍','표선면','남원읍','중문동','안덕면','대정읍',
'한경면','한림읍','애월읍','조천읍','구좌읍','제주시','우도면']

area['count'] = [df1.shape[0],df2.shape[0],df3.shape[0],df4.shape[0],df5.shape[0],df6.shape[0],df7.shape[0],df8.shape[0],df9.shape[0],df10.shape[0],df11.shape[0],df12.shape[0],df13.shape[0]]

area['mean_per_price'] = [df1.mean()[0],df2.mean()[0],df3.mean()[0],df4.mean()[0],df5.mean()[0],df6.mean()[0],df7.mean()[0],df8.mean()[0],df9.mean()[0],df10.mean()[0],df11.mean()[0],df12.mean()[0],df13.mean()[0]]
area['mean_star'] = [df1.mean()[1],df2.mean()[1],df3.mean()[1],df4.mean()[1],df5.mean()[1],df6.mean()[1],df7.mean()[1],df8.mean()[1],df9.mean()[1],df10.mean()[1],df11.mean()[1],df12.mean()[1],df13.mean()[1]]
area['mean_star_count'] = [df1.mean()[2],df2.mean()[2],df3.mean()[2],df4.mean()[2],df5.mean()[2],df6.mean()[2],df7.mean()[2],df8.mean()[2],df9.mean()[2],df10.mean()[2],df11.mean()[2],df12.mean()[2],df13.mean()[2]]

area['price1(<q1)'] = [df1_price1,df2_price1,df3_price1,df4_price1,df5_price1,df6_price1,df7_price1,df8_price1,df9_price1,df10_price1,df11_price1,df12_price1,df13_price1]
area['price1_star'] = [price1_star_mean1,price1_star_mean2,price1_star_mean3,price1_star_mean4,price1_star_mean5,price1_star_mean6,price1_star_mean7,price1_star_mean8,price1_star_mean9,price1_star_mean10,price1_star_mean11,price1_star_mean12,price1_star_mean13]
area['price1_review'] = [price1_review_mean1,price1_review_mean2,price1_review_mean3,price1_review_mean4,price1_review_mean5,price1_review_mean6,price1_review_mean7,price1_review_mean8,price1_review_mean9,price1_review_mean10,price1_review_mean11,price1_review_mean12,price1_review_mean13]
area['mean_price1(<q1)'] = [mean1_price1,mean2_price1,mean3_price1,mean4_price1,mean5_price1,mean6_price1,mean7_price1,mean8_price1,mean9_price1,mean10_price1,mean11_price1,mean12_price1,mean13_price1]

area['price2(<q2)'] = [df1_price2,df2_price2,df3_price2,df4_price2,df5_price2,df6_price2,df7_price2,df8_price2,df9_price2,df10_price2,df11_price2,df12_price2,df13_price2]
area['price2_star'] = [price2_star_mean1,price2_star_mean2,price2_star_mean3,price2_star_mean4,price2_star_mean5,price2_star_mean6,price2_star_mean7,price2_star_mean8,price2_star_mean9,price2_star_mean10,price2_star_mean11,price2_star_mean12,price2_star_mean13]
area['price2_review'] = [price2_review_mean1,price2_review_mean2,price2_review_mean3,price2_review_mean4,price2_review_mean5,price2_review_mean6,price2_review_mean7,price2_review_mean8,price2_review_mean9,price2_review_mean10,price2_review_mean11,price2_review_mean12,price2_review_mean13]
area['mean_price2(<q2)'] = [mean1_price2,mean2_price2,mean3_price2,mean4_price2,mean5_price2,mean6_price2,mean7_price2,mean8_price2,mean9_price2,mean10_price2,mean11_price2,mean12_price2,mean13_price2]

area['price3(<q3)'] = [df1_price3,df2_price3,df3_price3,df4_price3,df5_price3,df6_price3,df7_price3,df8_price3,df9_price3,df10_price3,df11_price3,df12_price3,df13_price3]
area['price3_star'] = [price3_star_mean1,price3_star_mean2,price3_star_mean3,price3_star_mean4,price3_star_mean5,price3_star_mean6,price3_star_mean7,price3_star_mean8,price3_star_mean9,price3_star_mean10,price3_star_mean11,price3_star_mean12,price3_star_mean13]
area['price3_review'] = [price3_review_mean1,price3_review_mean2,price3_review_mean3,price3_review_mean4,price3_review_mean5,price3_review_mean6,price3_review_mean7,price3_review_mean8,price3_review_mean9,price3_review_mean10,price3_review_mean11,price3_review_mean12,price3_review_mean13]
area['mean_price3(<q3)'] = [mean1_price3,mean2_price3,mean3_price3,mean4_price3,mean5_price3,mean6_price3,mean7_price3,mean8_price3,mean9_price3,mean10_price3,mean11_price3,mean12_price3,mean13_price3]

area['price4(>=q3)'] = [df1_price4,df2_price4,df3_price4,df4_price4,df5_price4,df6_price4,df7_price4,df8_price4,df9_price4,df10_price4,df11_price4,df12_price4,df13_price4]
area['price4_star'] = [price4_star_mean1,price4_star_mean2,price4_star_mean3,price4_star_mean4,price4_star_mean5,price4_star_mean6,price4_star_mean7,price4_star_mean8,price4_star_mean9,price4_star_mean10,price4_star_mean11,price4_star_mean12,price4_star_mean13]
area['price4_review'] = [price4_review_mean1,price4_review_mean2,price4_review_mean3,price4_review_mean4,price4_review_mean5,price4_review_mean6,price4_review_mean7,price4_review_mean8,price4_review_mean9,price4_review_mean10,price4_review_mean11,price4_review_mean12,price4_review_mean13]
area['mean_price4(>=q3)'] = [mean1_price4,mean2_price4,mean3_price4,mean4_price4,mean5_price4,mean6_price4,mean7_price4,mean8_price4,mean9_price4,mean10_price4,mean11_price4,mean12_price4,mean13_price4]


area['star_price1'] = [star_df1_price1,star_df2_price1,star_df3_price1,star_df4_price1,star_df5_price1,star_df6_price1,star_df7_price1,star_df8_price1,star_df9_price1,star_df10_price1,star_df11_price1,star_df12_price1,star_df13_price1]
area['star_price1_star'] = [star_price1_star_mean1,star_price1_star_mean2,star_price1_star_mean3,star_price1_star_mean4,star_price1_star_mean5,star_price1_star_mean6,star_price1_star_mean7,star_price1_star_mean8,star_price1_star_mean9,star_price1_star_mean10,star_price1_star_mean11,star_price1_star_mean12,star_price1_star_mean13]
area['star_price1_review'] = [star_price1_review_mean1,star_price1_review_mean2,star_price1_review_mean3,star_price1_review_mean4,star_price1_review_mean5,star_price1_review_mean6,star_price1_review_mean7,star_price1_review_mean8,star_price1_review_mean9,star_price1_review_mean10,star_price1_review_mean11,star_price1_review_mean12,star_price1_review_mean13]
area['star_mean_price1(<q1)'] = [star_mean1_price1,star_mean2_price1,star_mean3_price1,star_mean4_price1,star_mean5_price1,star_mean6_price1,star_mean7_price1,star_mean8_price1,star_mean9_price1,star_mean10_price1,star_mean11_price1,star_mean12_price1,star_mean13_price1]

area['star_price2'] = [star_df1_price2,star_df2_price2,star_df3_price2,star_df4_price2,star_df5_price2,star_df6_price2,star_df7_price2,star_df8_price2,star_df9_price2,star_df10_price2,star_df11_price2,star_df12_price2,star_df13_price2]
area['star_price2_star'] = [star_price2_star_mean1,star_price2_star_mean2,star_price2_star_mean3,star_price2_star_mean4,star_price2_star_mean5,star_price2_star_mean6,star_price2_star_mean7,star_price2_star_mean8,star_price2_star_mean9,star_price2_star_mean10,star_price2_star_mean11,star_price2_star_mean12,star_price2_star_mean13]
area['star_price2_review'] = [star_price2_review_mean1,star_price2_review_mean2,star_price2_review_mean3,star_price2_review_mean4,star_price2_review_mean5,star_price2_review_mean6,star_price2_review_mean7,star_price2_review_mean8,star_price2_review_mean9,star_price2_review_mean10,star_price2_review_mean11,star_price2_review_mean12,star_price2_review_mean13]
area['star_mean_price2(<q2)'] = [star_mean1_price2,star_mean2_price2,star_mean3_price2,star_mean4_price2,star_mean5_price2,star_mean6_price2,star_mean7_price2,star_mean8_price2,star_mean9_price2,star_mean10_price2,star_mean11_price2,star_mean12_price2,star_mean13_price2]

area['star_price3'] = [star_df1_price3,star_df2_price3,star_df3_price3,star_df4_price3,star_df5_price3,star_df6_price3,star_df7_price3,star_df8_price3,star_df9_price3,star_df10_price3,star_df11_price3,star_df12_price3,star_df13_price3]
area['star_price3_star'] = [star_price3_star_mean1,star_price3_star_mean2,star_price3_star_mean3,star_price3_star_mean4,star_price3_star_mean5,star_price3_star_mean6,star_price3_star_mean7,star_price3_star_mean8,star_price3_star_mean9,star_price3_star_mean10,star_price3_star_mean11,star_price3_star_mean12,star_price3_star_mean13]
area['star_price3_review'] = [star_price3_review_mean1,star_price3_review_mean2,star_price3_review_mean3,star_price3_review_mean4,star_price3_review_mean5,star_price3_review_mean6,star_price3_review_mean7,star_price3_review_mean8,star_price3_review_mean9,star_price3_review_mean10,star_price3_review_mean11,star_price3_review_mean12,star_price3_review_mean13]
area['star_mean_price3(<q3)'] = [star_mean1_price3,star_mean2_price3,star_mean3_price3,star_mean4_price3,star_mean5_price3,star_mean6_price3,star_mean7_price3,star_mean8_price3,star_mean9_price3,star_mean10_price3,star_mean11_price3,star_mean12_price3,star_mean13_price3]

area['star_price4'] = [star_df1_price4,star_df2_price4,star_df3_price4,star_df4_price4,star_df5_price4,star_df6_price4,star_df7_price4,star_df8_price4,star_df9_price4,star_df10_price4,star_df11_price4,star_df12_price4,star_df13_price4]
area['star_price4_star'] = [star_price4_star_mean1,star_price4_star_mean2,star_price4_star_mean3,star_price4_star_mean4,star_price4_star_mean5,star_price4_star_mean6,star_price4_star_mean7,star_price4_star_mean8,star_price4_star_mean9,star_price4_star_mean10,star_price4_star_mean11,star_price4_star_mean12,star_price4_star_mean13]
area['star_price4_review'] = [star_price4_review_mean1,star_price4_review_mean2,star_price4_review_mean3,star_price4_review_mean4,star_price4_review_mean5,star_price4_review_mean6,star_price4_review_mean7,star_price4_review_mean8,star_price4_review_mean9,star_price4_review_mean10,star_price4_review_mean11,star_price4_review_mean12,star_price4_review_mean13]
area['star_mean_price4(>=q3)'] = [star_mean1_price4,star_mean2_price4,star_mean3_price4,star_mean4_price4,star_mean5_price4,star_mean6_price4,star_mean7_price4,star_mean8_price4,star_mean9_price4,star_mean10_price4,star_mean11_price4,star_mean12_price4,star_mean13_price4]

area['weight_star'] = [weight_star1,weight_star2,weight_star3,weight_star4,weight_star5,weight_star6,weight_star7,weight_star8,weight_star9,weight_star10,weight_star11,weight_star12,weight_star13]
area["wstar_count"] = [wstar_count1,wstar_count2,wstar_count3,wstar_count4,wstar_count5,wstar_count6,wstar_count7,wstar_count8,wstar_count9,wstar_count10,wstar_count11,wstar_count12,wstar_count13]

area['wstar_price1'] = [wstar_df1_price1,wstar_df2_price1,wstar_df3_price1,wstar_df4_price1,wstar_df5_price1,wstar_df6_price1,wstar_df7_price1,wstar_df8_price1,wstar_df9_price1,wstar_df10_price1,wstar_df11_price1,wstar_df12_price1,wstar_df13_price1]
area['wstar_price1_star'] = [wstar_price1_star_mean1,wstar_price1_star_mean2,wstar_price1_star_mean3,wstar_price1_star_mean4,wstar_price1_star_mean5,wstar_price1_star_mean6,wstar_price1_star_mean7,wstar_price1_star_mean8,wstar_price1_star_mean9,wstar_price1_star_mean10,wstar_price1_star_mean11,wstar_price1_star_mean12,wstar_price1_star_mean13]
area['wstar_price1_review'] = [wstar_price1_review_mean1,wstar_price1_review_mean2,wstar_price1_review_mean3,wstar_price1_review_mean4,wstar_price1_review_mean5,wstar_price1_review_mean6,wstar_price1_review_mean7,wstar_price1_review_mean8,wstar_price1_review_mean9,wstar_price1_review_mean10,wstar_price1_review_mean11,wstar_price1_review_mean12,wstar_price1_review_mean13]
area['wstar_mean_price1(<q1)'] = [wstar_mean1_price1,wstar_mean2_price1,wstar_mean3_price1,wstar_mean4_price1,wstar_mean5_price1,wstar_mean6_price1,wstar_mean7_price1,wstar_mean8_price1,wstar_mean9_price1,wstar_mean10_price1,wstar_mean11_price1,wstar_mean12_price1,wstar_mean13_price1]

area['wstar_price2'] = [wstar_df1_price2,wstar_df2_price2,wstar_df3_price2,wstar_df4_price2,wstar_df5_price2,wstar_df6_price2,wstar_df7_price2,wstar_df8_price2,wstar_df9_price2,wstar_df10_price2,wstar_df11_price2,wstar_df12_price2,wstar_df13_price2]
area['wstar_price2_star'] = [wstar_price2_star_mean1,wstar_price2_star_mean2,wstar_price2_star_mean3,wstar_price2_star_mean4,wstar_price2_star_mean5,wstar_price2_star_mean6,wstar_price2_star_mean7,wstar_price2_star_mean8,wstar_price2_star_mean9,wstar_price2_star_mean10,wstar_price2_star_mean11,wstar_price2_star_mean12,wstar_price2_star_mean13]
area['wstar_price2_review'] = [wstar_price2_review_mean1,wstar_price2_review_mean2,wstar_price2_review_mean3,wstar_price2_review_mean4,wstar_price2_review_mean5,wstar_price2_review_mean6,wstar_price2_review_mean7,wstar_price2_review_mean8,wstar_price2_review_mean9,wstar_price2_review_mean10,wstar_price2_review_mean11,wstar_price2_review_mean12,wstar_price2_review_mean13]
area['wstar_mean_price2(<q2)'] = [wstar_mean1_price2,wstar_mean2_price2,wstar_mean3_price2,wstar_mean4_price2,wstar_mean5_price2,wstar_mean6_price2,wstar_mean7_price2,wstar_mean8_price2,wstar_mean9_price2,wstar_mean10_price2,wstar_mean11_price2,wstar_mean12_price2,wstar_mean13_price2]

area['wstar_price3'] = [wstar_df1_price3,wstar_df2_price3,wstar_df3_price3,wstar_df4_price3,wstar_df5_price3,wstar_df6_price3,wstar_df7_price3,wstar_df8_price3,wstar_df9_price3,wstar_df10_price3,wstar_df11_price3,wstar_df12_price3,wstar_df13_price3]
area['wstar_price3_star'] = [wstar_price3_star_mean1,wstar_price3_star_mean2,wstar_price3_star_mean3,wstar_price3_star_mean4,wstar_price3_star_mean5,wstar_price3_star_mean6,wstar_price3_star_mean7,wstar_price3_star_mean8,wstar_price3_star_mean9,wstar_price3_star_mean10,wstar_price3_star_mean11,wstar_price3_star_mean12,wstar_price3_star_mean13]
area['wstar_price3_review'] = [wstar_price3_review_mean1,wstar_price3_review_mean2,wstar_price3_review_mean3,wstar_price3_review_mean4,wstar_price3_review_mean5,wstar_price3_review_mean6,wstar_price3_review_mean7,wstar_price3_review_mean8,wstar_price3_review_mean9,wstar_price3_review_mean10,wstar_price3_review_mean11,wstar_price3_review_mean12,wstar_price3_review_mean13]
area['wstar_mean_price3(<q3)'] = [wstar_mean1_price3,wstar_mean2_price3,wstar_mean3_price3,wstar_mean4_price3,wstar_mean5_price3,wstar_mean6_price3,wstar_mean7_price3,wstar_mean8_price3,wstar_mean9_price3,wstar_mean10_price3,wstar_mean11_price3,wstar_mean12_price3,wstar_mean13_price3]

area['wstar_price4'] = [wstar_df1_price4,wstar_df2_price4,wstar_df3_price4,wstar_df4_price4,wstar_df5_price4,wstar_df6_price4,wstar_df7_price4,wstar_df8_price4,wstar_df9_price4,wstar_df10_price4,wstar_df11_price4,wstar_df12_price4,wstar_df13_price4]
area['wstar_price4_star'] = [wstar_price4_star_mean1,wstar_price4_star_mean2,wstar_price4_star_mean3,wstar_price4_star_mean4,wstar_price4_star_mean5,wstar_price4_star_mean6,wstar_price4_star_mean7,wstar_price4_star_mean8,wstar_price4_star_mean9,wstar_price4_star_mean10,wstar_price4_star_mean11,wstar_price4_star_mean12,wstar_price4_star_mean13]
area['wstar_price4_review'] = [wstar_price4_review_mean1,wstar_price4_review_mean2,wstar_price4_review_mean3,wstar_price4_review_mean4,wstar_price4_review_mean5,wstar_price4_review_mean6,wstar_price4_review_mean7,wstar_price4_review_mean8,wstar_price4_review_mean9,wstar_price4_review_mean10,wstar_price4_review_mean11,wstar_price4_review_mean12,wstar_price4_review_mean13]
area['wstar_mean_price4(>=q3)'] = [wstar_mean1_price4,wstar_mean2_price4,wstar_mean3_price4,wstar_mean4_price4,wstar_mean5_price4,wstar_mean6_price4,wstar_mean7_price4,wstar_mean8_price4,wstar_mean9_price4,wstar_mean10_price4,wstar_mean11_price4,wstar_mean12_price4,wstar_mean13_price4]

area['lable'] = [1,2,3,4,5,6,7,8,9,10,11,12,13]


area
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>area</th>
      <th>price1_star</th>
      <th>price1_review</th>
      <th>mean_price1(&lt;q1)</th>
      <th>star_price1_star</th>
      <th>star_price1_review</th>
      <th>star_mean_price1(&lt;q1)</th>
      <th>wstar_price1_star</th>
      <th>wstar_price1_review</th>
      <th>wstar_mean_price1(&lt;q1)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>성산읍</td>
      <td>4.722925</td>
      <td>124.216981</td>
      <td>71775.424528</td>
      <td>4.901714</td>
      <td>100.657143</td>
      <td>71136.371429</td>
      <td>4.725000</td>
      <td>116.028302</td>
      <td>73266.542857</td>
    </tr>
    <tr>
      <th>1</th>
      <td>표선면</td>
      <td>4.838519</td>
      <td>100.444444</td>
      <td>67900.777778</td>
      <td>4.921250</td>
      <td>66.000000</td>
      <td>80025.375000</td>
      <td>4.781538</td>
      <td>79.407407</td>
      <td>59035.153846</td>
    </tr>
    <tr>
      <th>2</th>
      <td>남원읍</td>
      <td>4.684800</td>
      <td>39.720000</td>
      <td>66964.040000</td>
      <td>4.930000</td>
      <td>38.428571</td>
      <td>67769.000000</td>
      <td>4.630000</td>
      <td>24.000000</td>
      <td>69406.800000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>중문동</td>
      <td>4.737300</td>
      <td>128.070000</td>
      <td>70105.850000</td>
      <td>4.902581</td>
      <td>182.935484</td>
      <td>78173.000000</td>
      <td>4.786364</td>
      <td>110.020000</td>
      <td>71143.690909</td>
    </tr>
    <tr>
      <th>4</th>
      <td>안덕면</td>
      <td>4.723019</td>
      <td>75.113208</td>
      <td>70960.773585</td>
      <td>4.895238</td>
      <td>97.095238</td>
      <td>72935.476190</td>
      <td>4.842632</td>
      <td>59.698113</td>
      <td>70176.473684</td>
    </tr>
    <tr>
      <th>5</th>
      <td>대정읍</td>
      <td>4.766400</td>
      <td>47.040000</td>
      <td>71751.880000</td>
      <td>4.932222</td>
      <td>66.888889</td>
      <td>72148.000000</td>
      <td>4.870000</td>
      <td>26.040000</td>
      <td>70753.333333</td>
    </tr>
    <tr>
      <th>6</th>
      <td>한경면</td>
      <td>4.757895</td>
      <td>68.289474</td>
      <td>78360.263158</td>
      <td>4.900000</td>
      <td>73.636364</td>
      <td>81198.090909</td>
      <td>4.843333</td>
      <td>47.157895</td>
      <td>82450.250000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>한림읍</td>
      <td>4.728704</td>
      <td>72.166667</td>
      <td>72172.148148</td>
      <td>4.915500</td>
      <td>43.550000</td>
      <td>71534.600000</td>
      <td>4.690500</td>
      <td>53.888889</td>
      <td>70194.200000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>애월읍</td>
      <td>4.754921</td>
      <td>75.666667</td>
      <td>75478.015873</td>
      <td>4.907826</td>
      <td>88.347826</td>
      <td>77562.260870</td>
      <td>4.769091</td>
      <td>62.587302</td>
      <td>79804.242424</td>
    </tr>
    <tr>
      <th>9</th>
      <td>조천읍</td>
      <td>4.722692</td>
      <td>69.461538</td>
      <td>75902.384615</td>
      <td>4.897500</td>
      <td>70.166667</td>
      <td>75791.833333</td>
      <td>4.662727</td>
      <td>53.153846</td>
      <td>76687.636364</td>
    </tr>
    <tr>
      <th>10</th>
      <td>구좌읍</td>
      <td>4.713333</td>
      <td>74.438596</td>
      <td>72634.508772</td>
      <td>4.874706</td>
      <td>63.529412</td>
      <td>77823.470588</td>
      <td>4.714286</td>
      <td>47.456140</td>
      <td>76649.428571</td>
    </tr>
    <tr>
      <th>11</th>
      <td>제주시</td>
      <td>4.757250</td>
      <td>100.093750</td>
      <td>74153.175000</td>
      <td>4.900635</td>
      <td>83.317460</td>
      <td>74556.650794</td>
      <td>4.725405</td>
      <td>85.768750</td>
      <td>74201.418919</td>
    </tr>
    <tr>
      <th>12</th>
      <td>우도면</td>
      <td>4.557500</td>
      <td>22.000000</td>
      <td>48500.500000</td>
      <td>4.920000</td>
      <td>13.000000</td>
      <td>68471.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>


